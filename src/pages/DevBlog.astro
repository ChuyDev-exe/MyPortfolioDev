---
import NavItem from "../components/NavItem.astro";
import BlogLayout from "../layouts/BlogLayout.astro";
import { TagTopic } from "../components/Tools/Tags";
import { getCollection } from 'astro:content';

// Get all blog posts and sort by date (most recent first)
const allPosts = await getCollection('posts');
const sortedPosts = allPosts.sort((a, b) => 
  new Date(b.data.date).getTime() - new Date(a.data.date).getTime()
);

// Get the first 6 posts for featured section
const featuredPosts = sortedPosts.slice(0, 6);
// Get the next 4 posts for additional articles
const additionalPosts = sortedPosts.slice(6, 10);
---

<BlogLayout title="Blog Dev">
    <nav class="flex gap-5 flex-row justify-center w-full my-10">
        <NavItem title="Experience" href="https://jesusvelez.xyz#Experiencia" />
        <NavItem title="Projects" href="https://jesusvelez.xyz#Projects"/>
        <NavItem title="Portfolio" href="https://jesusvelez.xyz" />
    </nav>

    <div class="flex w-full items-center justify-center flex-col mb-20">
        <section class="h-[500px] flex flex-col w-[80%]">
            <div class="py-3 px-4 mx-auto max-w-7xl text-center lg:py-10">
                <h1
                    class="mb-2 text-4xl font-extrabold tracking-tight leading-none md:text-5xl lg:text-8xl text-white"
                >
                    Find your Dev problem here
                </h1>
                <h1
                    class="mb-10 text-2xl font-extrabold tracking-tight leading-none md:text-4xl lg:text-6xl text-white"
                >
                    Was my problem too
                </h1>
                <p
                    class=" text-lg font-normal text-gray-500 lg:text-xl sm:px-16 lg:px-48 dark:text-gray-400"
                >
                    Find my Tech Tips & Clicks for <br />
                    VsCode, Linux & Microcontrollers Problematics
                </p>
            </div>
            <a
                href="/Blog/Posts"
                class="md:mr-[200px] md:self-end text-white hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-lg px-7 py-4 text-center inline-flex justify-center items-center bg-blue-600 dark:hover:bg-51E4B8 dark:focus:ring-blue-800"
            >
                Let's check Post
                <svg
                    class="rtl:rotate-180 w-3.5 h-3.5 ms-2"
                    aria-hidden="true"
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 14 10"
                >
                    <path
                        stroke="currentColor"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M1 5h12m0 0L9 1m4 4L9 9"></path>
                </svg>
            </a>
        </section>
    </div>

    <div class="flex w-full items-center justify-center flex-col gap-[30px]">
        <h1
            class="font-extrabold tracking-tight leading-none text-5xl text-white"
        >
            Latest Technical Articles
        </h1>
        <p class="text-gray-300 text-center max-w-2xl text-lg">
            Comprehensive guides covering backend development, embedded systems, microcontrollers, and modern web technologies
        </p>

        <div class="grid lg:grid-cols-3 md:grid-cols-2 sm:grid-cols-1 gap-6 w-[90%] max-w-7xl">
            
            {featuredPosts.map((post, index) => {
              const colors = [
                { bg: "from-purple-900/30 to-blue-900/30", border: "border-purple-500/30 hover:border-purple-400/50", indicator: "bg-purple-500", text: "text-purple-300", link: "text-purple-400 hover:text-purple-300" },
                { bg: "from-orange-900/30 to-red-900/30", border: "border-orange-500/30 hover:border-orange-400/50", indicator: "bg-orange-500", text: "text-orange-300", link: "text-orange-400 hover:text-orange-300" },
                { bg: "from-blue-900/30 to-cyan-900/30", border: "border-blue-500/30 hover:border-blue-400/50", indicator: "bg-blue-500", text: "text-blue-300", link: "text-blue-400 hover:text-blue-300" },
                { bg: "from-green-900/30 to-emerald-900/30", border: "border-green-500/30 hover:border-green-400/50", indicator: "bg-green-500", text: "text-green-300", link: "text-green-400 hover:text-green-300" },
                { bg: "from-red-900/30 to-pink-900/30", border: "border-red-500/30 hover:border-red-400/50", indicator: "bg-red-500", text: "text-red-300", link: "text-red-400 hover:text-red-300" },
                { bg: "from-indigo-900/30 to-purple-900/30", border: "border-indigo-500/30 hover:border-indigo-400/50", indicator: "bg-indigo-500", text: "text-indigo-300", link: "text-indigo-400 hover:text-indigo-300" }
              ];
              const colorScheme = colors[index % colors.length];
              const publishDate = new Date(post.data.date).toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'short',
                day: 'numeric'
              });
              
              return (
                <div class={`bg-linear-to-br ${colorScheme.bg} border ${colorScheme.border} rounded-lg p-6 transition-all duration-300 hover:transform hover:scale-[1.02]`}>
                  <div class="flex items-center gap-2 mb-3">
                    <div class={`w-3 h-3 ${colorScheme.indicator} rounded-full`}></div>
                    <span class={`${colorScheme.text} text-sm font-medium`}>
                      {post.data.tags?.[0] || 'Technical'}
                    </span>
                    <span class="text-gray-400 text-xs">• {publishDate}</span>
                  </div>
                  <h3 class="text-white font-bold text-xl mb-2">{post.data.title}</h3>
                  <p class="text-gray-300 text-sm mb-4">{post.data.description}</p>
                  <div class="flex flex-wrap gap-1 mb-4">
                    {post.data.tags?.slice(0, 3).map((tag: string) => (
                      <span class={`px-2 py-1 ${colorScheme.indicator}/20 ${colorScheme.text} text-xs rounded`}>{tag}</span>
                    ))}
                  </div>
                  <a href={`/Blog/${post.slug}`} class={`${colorScheme.link} font-medium text-sm`}>Read More →</a>
                </div>
              );
            })}

        </div>


        <a
            href="/Blog/Posts"
            class="text-white  focus:ring-4 focus:outline-none focus:ring-cyan-300 dark:focus:ring-cyan-800 font-medium rounded-lg text-lg px-8 py-4 text-center mt-8 mb-8 transform hover:scale-105 transition-all duration-300"
            >Explore All Articles</a
        >
    </div>
</BlogLayout>
